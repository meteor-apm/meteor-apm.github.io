<!DOCTYPE html>
<html lang='en'>
<head>
  
    <meta charset="UTF-8">
  <title>Getting Started With Meteor APM - Meteor APM Academy</title>
  <link rel="stylesheet" href="/styles.css">
  <script src="//use.typekit.net/ypr5vji.js"></script>
  <script src="/scripts.js"></script>
  <script>try{Typekit.load();}catch(e){}</script>
  <link rel="stylesheet" href="/vendor/zenburn.css">
  <script src='/vendor/highlight.pack.js'></script>
  <script>hljs.initHighlightingOnLoad();</script>
</head>
<body>
  
  
    <header id="topbar">
    <div class="container">
      <a href="/" class="logo">Meteor APM</a>
      <nav class="menu">
        
          
            <a href="http://support.meteorapm.com/knowledgebase">Docs</a>
          
        
          
            <a href="/blog">Blog</a>
          
        
          
            <a class="current" href="/academy">Academy</a>
          
        
          
            <a href="http://support.meteorapm.com/forums/224274-general">Support</a>
          
        
      </nav>
    </div>
  </header>

  <section id="main">
    <a href="http://mad.ly/signups/106626/join" class="subscribe">Subscribe to Academy</a>
    <article class="post single post-container">
  
  <h1 class="title">Getting Started With Meteor APM</h1>
  
  <p>This guide will help you get started with Meteor APM to identify how your app behaves and help you take necessary actions.</p>

<h2 id="install-and-configure-meteor-apm">Install and Configure Meteor APM</h2>

<p>Adding APM support for your app is pretty simple. Simply add the APM smart-package as follows:</p>

<pre><code>mrt add apm
</code></pre>

<p>Then configure your app by adding this code into any file in your app’s server directory.</p>

<pre><code>Apm.connect('&lt;appId&gt;', '&lt;appSecret&gt;')
</code></pre>

<blockquote>
  <p>It is very important to add this code into server directory; if you do not, your Meteor APM app credentials will be exposed to the client.</p>
</blockquote>

<h2 id="a-good-way-to-configure">A Good Way to Configure</h2>

<p>Normally, it is a good practice to not hard code API credentials. For that, you can use <a href="http://docs.meteor.com/#meteor_settings"><code>Meteor.settings</code></a> or Environmental Variables.</p>

<h3 id="using-meteorsettings">Using Meteor.settings</h3>

<p>Your <code>settings.json</code> file will look like this:</p>

<pre><code>{
  ...
  "apm": {
    "appId": "&lt;your appId&gt;",
    "appSecret": "&lt;your appSecret&gt;"
  }
  ...
}
</code></pre>

<p>This is the code that runs on the server:</p>

<pre><code>if(Meteor.settings &amp;&amp; Meteor.settings.apm) {
  var apmAuth = Meteor.settings.apm;
  Apm.connect(apmAuth.appId, apmAuth.appSecret);
}
</code></pre>

<p>Deploy and run your app with the <a href="https://groups.google.com/forum/#!topic/meteor-talk/K79-i3LYL3g"><code>settings.json</code></a> file. If you have not provided APM credentials via Meteor.settings, you won’t be connecting the APM. This is ideal for developing your app locally.</p>

<h3 id="using-environmental-variables">Using Environmental Variables</h3>

<p>Add the following environmental variables when you are running your app (possibly in your deployment environment):</p>

<pre><code>APM_APP_ID=&lt;your appId&gt;
APM_APP_SECRET=&lt;your apmSecret&gt;
</code></pre>

<p>This is how your server code should look:</p>

<pre><code>var apmAppId = process.env.APM_APP_ID;
var appAppSecret = process.env.APM_APP_SECRET;
if(apmAppId &amp;&amp; apmAppSecret) {
  Apm.connect(apmAppId, apmAppSecret);
}
</code></pre>

<p>Deploy and run your app. As with <code>Meteor.settings</code>, if you have not exposed environmental variables, you won’t be connecting to the APM. This is ideal for dev environments.</p>

<p>After you’ve successfully connected with APM, you’ll be able to see messages like the ones below, which indicate you’ve successfully authenticated with APM.</p>

<p><img src="https://i.cloudup.com/w9hkMusPNE.png" alt="Successfully Connected to the APM" /></p>

<p><em><strong>After about one minute, your data will be processed and will be available on the UI.</strong></em></p>

<h2 id="meteor-apm-dashboard">Meteor APM Dashboard</h2>

<p>The Meteor APM Dashboard is very nicely designed and super easy to use. Yep, it’s a Meteor App too. This is the overview of the Meteor APM Dashboard.</p>

<p><img src="https://i.cloudup.com/awL09AN93C.png" alt="Meteor APM Dashboard" /></p>

<p>You should not need extra help to become familiar with the Dashboard. However, if you do need clarification, refer to this <a href="http://support.meteorapm.com/knowledgebase/articles/306862-page-navigation">guide</a> or click the inline “Help” icons.</p>

<h2 id="how-to-use-meteor-apm">How to Use Meteor APM</h2>

<p>Let’s assume you’ve added Meteor APM and it has enough information (about 30 minutes of runtime data) to provide a good analysis. There is no right or wrong way to use Meteor APM but I will suggest two simple ways to get started.</p>

<h3 id="finding-bottlenecks-in-meteor-methods-and-fixing-them">Finding Bottlenecks in Meteor Methods and Fixing Them</h3>

<p>Normally, for a typical Meteor application, the Average <a href="http://support.meteorapm.com/knowledgebase/articles/347424-response-time">Response Time</a> of a Meteor Method should not be more than 200ms. If it is more than this, in many cases there are ways to improve performance.</p>

<ul>
  <li>First click on <strong>Methods</strong> on the Main Menu and look at the Response Time.</li>
  <li>Also look at the Response Time graph for any spikes.</li>
  <li>If you find places where the Response Time is higher than 200ms, click the <strong>Detailed View</strong> button on the Sub Menu.</li>
  <li>Then find the Response Time and click on the spike in the graph.</li>
  <li>This will show a set of traced methods at that time.</li>
  <li>Click on a trace to see exactly what has happened on that method at that time.</li>
  <li>Follow this <a href="https://meteorapm.com/academy/how-to-optimize-your-methods-and-publications/">guide</a> to understand the traced data and improve your method accordingly.</li>
</ul>

<iframe width="640" height="480" src="//www.youtube.com/embed/4vt2M7-bsDQ" frameborder="0" allowfullscreen="1">
</iframe>

<blockquote>
  <p>You can follow the <a href="https://www.youtube.com/watch?v=CQtmnzIlzE4&amp;feature=youtu.be">same process</a> for PubSub.</p>
</blockquote>

<h3 id="finding-methods-you-need-to-improve">Finding Methods You Need to Improve</h3>

<p>In your app, you might be using many Meteor Methods. You may need to improve all of them. It is a good idea to start, though, with the ones that have more impact. We’ve identified that if you can improve a method with higher Throughput, it will impact more on the total performance gain. To do this, follow these steps:</p>

<ul>
  <li>Click on the <strong>Detailed View</strong> of Methods.</li>
  <li>Sort the Methods Breakdown by <a href="http://support.meteorapm.com/knowledgebase/articles/347444-throughput">Throughput</a> (the default sort criteria).</li>
  <li>Click on a method name in the Methods Breakdown.</li>
  <li>In the <a href="http://support.meteorapm.com/knowledgebase/articles/347445-method-recommendations">Recommendations</a> section, you will see the impact you can have if you improve the selected method.</li>
  <li>Click on the Response Time Graph and find a trace.</li>
  <li>Analyze it with this <a href="https://meteorapm.com/academy/how-to-optimize-your-methods-and-publications/">guide</a> and improve your method if possible.</li>
  <li>Do the same for all methods.</li>
</ul>

<iframe width="640" height="480" src="//www.youtube.com/embed/REUrBU7x6GU" frameborder="0" allowfullscreen="1">
</iframe>

<blockquote>
  <p>You can follow the <a href="https://www.youtube.com/watch?v=CTk0Qvj0n6Y&amp;feature=youtu.be">same process</a> for PubSub, but you will need to sort the Pub/Sub Breakdown by <a href="http://support.meteorapm.com/knowledgebase/articles/347439-subrate">SubRate</a> instead of Throughput.</p>
</blockquote>

<p>There are many more ways to improve your app with Meteor APM. Explore and <a href="http://support.meteorapm.com/forums/224274-general">share</a> your discoveries with us. You can also refer the tutorials on the <a href="https://meteorapm.com/academy/">Meteor APM Academy</a> to find more ways to improve your app.</p>

<p>If you need help or more information, contact arunoda at <code>arunoda [at] meteorhacks.com</code>. Good luck and don’t forget to share your <a href="http://support.meteorapm.com/forums/224274-general">experience</a> with us.</p>

</article>
    <article class="container comments">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'meteorapm'; // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</article>
  </section>

    <footer id="footer">
    <div class="container">
      <nav class="menu">
        <a href="/terms_and_conditions.html">Terms of Service</a>
        <a href="/privacy_policy.html">Privacy Policy</a>
      </nav>
      <br style="clear:both">
    </div>
  </footer>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-48364339-2', 'meteorapm.com');
    ga('send', 'pageview');
  </script>

</body>
</html>